{% extends "base/base.html" %}

{% block page_heading %}
Manage test source versions
{% endblock %}

{% block main_content %}
<div class="card">
  <div class="card-body">
    <h4 class="card-title">
      You have uploaded {{ number_test_sources_uploaded }} of {{ test_versions }} source pdfs
      {% if all_source_tests_uploaded %}
      <i class="bi bi-check-circle text-success"></i>
      {% else %}
      <i class="bi bi-exclamation-diamond-fill text-warning"></i>
      {% endif %}
    </h4>
    <div class="card-text">
      <p>
	Each PDF must have exactly {{ number_of_pages }} pages
      </p>
    </div>
  </div>
</div>

{% for version,test_source in uploaded_test_sources.items %}
<div>
  <div class="card">
    <div class="card-body">
      
      {% if test_source %}

      <h5 class="card-title">PDF for version {{version}} uploaded
      <i class="bi bi-check-circle text-success"></i>
      </h5>
      <p class="card-text">
	sha256: <span class="badge bg-info">{{test_source.1}}</span>
      </p>
      <a class="btn btn-success" target="_blank" href="{{version}}">View</a>
      <button class="btn btn-danger"
	      hx-delete="{{version}}"
	      hx-confirm="Are you sure?"
	      hx-target="body"
              hx-swap="outerHTML"	      
	      >Delete</a>
      {% else %}
      <h5 class="card-title">Upload PDF for version {{version}}
      <i class="bi bi-exclamation-diamond-fill text-warning"></i>
      </h5>
      <div class="card-text">
      <form enctype="multipart/form-data"
            id="form"
            method="post"
            action="/preparation/test_source/{{version}}">
        {% csrf_token %}
        <div>
          <input type="file" accepts=".pdf" name="source_pdf" required>
          <button class="btn btn-primary" type="submit">upload</button>
        </div>
      </form>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endfor %}


{% endblock %}
