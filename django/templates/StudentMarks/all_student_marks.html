<!--
    SPDX-License-Identifier: AGPL-3.0-or-later
    Copyright (C) 2023 Julian Lapenna
-->
{% extends "base/base.html" %}
{% load static %}
{% block page_heading %}Student Marks{% endblock page_heading %}
{% block main_content %}
{% comment %} Table {% endcomment %}
<div style="width: 98%;">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th scope="col">ID</th>
                {% for i in n_questions %}
                <th scope="col">Question {{ i }}</th>
                {% endfor %}
            </tr>
        </thead>
        {% comment %} I have a feeling this breaks down if papers are partially graded (#2775) {% endcomment %}
        <tbody>
            {% for p_key, p_val in papers.items %}
            <tr>
                <td>{{ p_key }}</td>

                {% comment %}Not graded{% endcomment %}

                {% if not p_val %}
                {% for i in n_questions %}
                <td>Not graded</td>
                {% endfor %}

                {% comment %}Fully graded{% endcomment %}

                {% elif p_val|length == n_questions|length %}
                {% for q_key, q_val in p_val.items %}
                <td>{{ q_val.student_mark }}</td>
                {% endfor %}

                {% comment %}Partially graded{% endcomment %}

                {% else %}
                {% for i in n_questions %}
                <td>
                {% if i in p_val %}
                {% for q_key, q_val in p_val.items %}
                {% if q_key == i %}
                {{ q_val.student_mark }}
                {% endif %}
                {% endfor %}
                {% else %}
                Not graded
                {% endif %}
                </td>
                {% endfor %}
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
{% endblock %}