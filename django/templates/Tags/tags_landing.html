<!-- 
    SPDX-License-Identifier: AGPL-3.0-or-later
    Copyright (C) 2023 Julian Lapenna
-->

{% extends 'base/base.html' %}
{% load static %}

{% block page_heading %}Tags{% endblock %}

{% block main_content %}
<div>
    <style>
        table {
            border-collapse: collapse;
            width: 40%;
        }

        th,
        td {
            padding: 1px;
            padding-left: 4px;
            text-align: left;
            border: 1px solid #ccc;
        }

        th {
            background-color: #333;
            color: #fff;
        }

        tbody tr:nth-child(even) {
            background-color: #e9e9e9;
        }

        th.id-column {
            width: 100px;
        }

        th.tag-column {
            width: 200px;
        }
    </style>
    <div style="display: flex;">
        <div style="flex: 1;">
            <h5> Tag filtering form: </h5>
            <form method="POST" action="{% url 'tag_filter' %}">
                {% csrf_token %}
                {{ text_field_form.as_p }}
                <button type="submit">Submit</button>
            </form>
            <br><br>
            You are filtering for tags containing "{{ tag_filter_text }}" with
            strict matching {{ tag_filter_strict }}.
        </div>
        <div style="flex: 1.8;">
            <table>
                <thead>
                    <tr>
                        <th class="id-column">Tags</th>
                        <th class="tag-column">Number of uses</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tag, count in tag_counts.items %}
                    <tr>
                        <td class="id-column">{{ tag.text }}</td>
                        <td class="tag-column">{{ count }}</td>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <br><br>
        </div>
    </div>
    <div>
        <br>
        <h5> Papers by tags: </h5>
        <br>
        <table>
            <thead>
                <tr>
                    <th class="id-column">Paper ID</th>
                    <th class="tag-column">Matching Tags</th>
                </tr>
            </thead>
            <tbody>
                {% for id, tags in papers.items %}
                <tr>
                    <td class="id-column">{{ id.paper_number }}</td>
                    <td class="tag-column">
                        {% for tag in tags %}
                        {% if tag %}
                        <a href="{% url 'tag_item' tag %}">{{ tag }}</a><br>
                        {% endif %}
                        {% endfor %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}